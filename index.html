<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>360° Custom Software Setup</title>
  <style>
    body { 
      font-family: "Poppins", sans-serif; 
      padding: 20px; 
    }
    .step { 
      display: none; 
    }
    .step.active { 
      display: block; 
    }
    .bubble-entry { 
      margin-bottom: 15px; 
      padding: 10px; 
      border: 1px solid #ccc; 
      border-radius: 5px; 
    }
    input, textarea, select { 
      width: 100%; 
      padding: 8px; 
      margin-top: 5px; 
      box-sizing: border-box;
    }
    button { 
      padding: 10px 15px; 
      margin-top: 10px; 
      cursor: pointer; 
    }
    #addBubble { 
      background-color: #007bff; 
      color: #fff; 
      border: none; 
      border-radius: 5px; 
    }
  </style>
</head>
<body>

  <!-- Step 1: Choose number of units -->
  <div id="step1" class="step active">
    <h2>Step 1: Choose Number of Units</h2>
    <select id="numUnitsSelect">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="Villa">Villa</option>
    </select>
    <br>
    <button id="next1">Next</button>
  </div>

  <!-- Step 2: Name the units -->
  <div id="step2" class="step">
    <h2>Step 2: Name Your Units</h2>
    <div id="unitNamesContainer"></div>
    <button id="next2">Next</button>
  </div>

  <!-- Step 3: Setup 360° Bubble Details -->
  <div id="step3" class="step">
    <h2>Step 3: Setup 360° Bubble Details</h2>
    <p>For each bubble, enter the room name (the bubble label), the 360 image file name (as uploaded to GitHub), and select the unit it belongs to.</p>
    <div id="bubbleEntriesContainer"></div>
    <button id="addBubble">+ Add Bubble</button>
    <br>
    <button id="finish">Finish Setup</button>
  </div>

  <script>
    let numUnits;
    let unitNames = [];

    // Helper function to display the appropriate step.
    function showStep(stepNumber) {
      document.querySelectorAll('.step').forEach((step, index) => {
        step.classList.toggle('active', index === stepNumber - 1);
      });
    }

    // Step 1: Handle the Next button.
    document.getElementById('next1').addEventListener('click', function() {
      const selection = document.getElementById('numUnitsSelect').value;
      if (selection === "Villa") {
        numUnits = 1;
      } else {
        numUnits = parseInt(selection);
      }
      // Create input fields for unit names.
      const container = document.getElementById('unitNamesContainer');
      container.innerHTML = ''; // Clear any previous inputs.
      for (let i = 0; i < numUnits; i++) {
        const label = document.createElement('label');
        label.textContent = `Unit ${i + 1} Name:`;
        const input = document.createElement('input');
        input.type = 'text';
        // If Villa was selected, default the unit name to "Villa"
        input.placeholder = (selection === "Villa") ? "Villa" : `Enter name for Unit ${i + 1}`;
        if (selection === "Villa") {
          input.value = "Villa";
        }
        input.id = `unitName${i}`;
        container.appendChild(label);
        container.appendChild(input);
      }
      showStep(2);
    });

    // Step 2: Handle the Next button.
    document.getElementById('next2').addEventListener('click', function() {
      unitNames = [];
      for (let i = 0; i < numUnits; i++) {
        const name = document.getElementById(`unitName${i}`).value.trim();
        if (!name) {
          alert(`Please enter a name for Unit ${i + 1}.`);
          return;
        }
        unitNames.push(name);
      }
      showStep(3);
    });

    // Function to add a new bubble entry with room name, file name, and unit selection.
    function addBubbleEntry() {
      const container = document.getElementById('bubbleEntriesContainer');
      const entryDiv = document.createElement('div');
      entryDiv.className = 'bubble-entry';

      // Text input for room name (bubble label).
      const roomLabel = document.createElement('label');
      roomLabel.textContent = "Room Name (Bubble Label):";
      const roomInput = document.createElement('input');
      roomInput.type = 'text';
      roomInput.placeholder = 'e.g., Living Room';

      // Text input for the 360 image file name.
      const fileLabel = document.createElement('label');
      fileLabel.textContent = "360 Image File Name:";
      const fileInput = document.createElement('input');
      fileInput.type = 'text';
      fileInput.placeholder = 'e.g., hall';

      // Dropdown for selecting the unit.
      const unitLabel = document.createElement('label');
      unitLabel.textContent = "Select Unit:";
      const unitSelect = document.createElement('select');
      unitNames.forEach(unit => {
        const option = document.createElement('option');
        option.value = unit;
        option.textContent = unit;
        unitSelect.appendChild(option);
      });

      // Append all elements to the bubble entry container.
      entryDiv.appendChild(roomLabel);
      entryDiv.appendChild(roomInput);
      entryDiv.appendChild(fileLabel);
      entryDiv.appendChild(fileInput);
      entryDiv.appendChild(unitLabel);
      entryDiv.appendChild(unitSelect);

      container.appendChild(entryDiv);
    }

    // Handler for the "Add Bubble" button.
    document.getElementById('addBubble').addEventListener('click', addBubbleEntry);

    // Handler for the "Finish Setup" button – logs the collected data.
    document.getElementById('finish').addEventListener('click', function() {
      const bubbleData = [];
      const entries = document.querySelectorAll('.bubble-entry');
      let complete = true;
      entries.forEach(entry => {
        const inputs = entry.querySelectorAll('input[type="text"]');
        const roomName = inputs[0].value.trim();
        const imageFileName = inputs[1].value.trim();
        const unitSelect = entry.querySelector('select');
        const selectedUnit = unitSelect.value;
        if (!roomName || !imageFileName || !selectedUnit) {
          alert('Please complete all bubble entries.');
          complete = false;
          return;
        }
        bubbleData.push({
          roomLabel: roomName,
          imageFileName: imageFileName,
          unit: selectedUnit
        });
      });
      if (!complete) return;
      console.log('Unit Names:', unitNames);
      console.log('Bubble Data:', bubbleData);
      alert('Setup finished! Check the console for output.');
    });

    // Initialize with one bubble entry by default.
    addBubbleEntry();
  </script>
</body>
</html>