<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>360° Custom Software Setup</title>
  <style>
    body { font-family: "Poppins", sans-serif; padding: 20px; }
    .step { display: none; }
    .step.active { display: block; }
    .bubble-entry { margin-bottom: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
    input, textarea { width: 100%; padding: 8px; margin-top: 5px; }
    button { padding: 10px 15px; margin-top: 10px; cursor: pointer; }
    #addBubble { background-color: #007bff; color: #fff; border: none; border-radius: 5px; }
  </style>
</head>
<body>

  <!-- Step 1: Enter number of units -->
  <div id="step1" class="step active">
    <h2>Step 1: Number of Units</h2>
    <input type="number" id="numUnits" min="1" placeholder="Enter number of units" />
    <br>
    <button id="next1">Next</button>
  </div>

  <!-- Step 2: Name the units -->
  <div id="step2" class="step">
    <h2>Step 2: Name Your Units</h2>
    <div id="unitNamesContainer"></div>
    <button id="next2">Next</button>
  </div>

  <!-- Step 3: Setup 360° Bubble Details -->
  <div id="step3" class="step">
    <h2>Step 3: Setup 360° Bubble Details</h2>
    <p>For each bubble, enter the room name (the label that the bubble shows) and the 360 image file name (as uploaded to GitHub).</p>
    <div id="bubbleEntriesContainer"></div>
    <button id="addBubble">+ Add Bubble</button>
    <br>
    <button id="finish">Finish Setup</button>
  </div>

  <script>
    let numUnits;
    let unitNames = [];

    // Helper function to display the appropriate step.
    function showStep(stepNumber) {
      document.querySelectorAll('.step').forEach((step, index) => {
        step.classList.toggle('active', index === stepNumber - 1);
      });
    }

    // Step 1: Handle the Next button.
    document.getElementById('next1').addEventListener('click', function() {
      numUnits = parseInt(document.getElementById('numUnits').value);
      if (!numUnits || numUnits < 1) {
        alert('Please enter a valid number of units.');
        return;
      }
      const container = document.getElementById('unitNamesContainer');
      container.innerHTML = '';
      for (let i = 0; i < numUnits; i++) {
        const label = document.createElement('label');
        label.textContent = `Unit ${i + 1} Name:`;
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = `Enter name for Unit ${i + 1}`;
        input.id = `unitName${i}`;
        container.appendChild(label);
        container.appendChild(input);
      }
      showStep(2);
    });

    // Step 2: Handle the Next button.
    document.getElementById('next2').addEventListener('click', function() {
      unitNames = [];
      for (let i = 0; i < numUnits; i++) {
        const name = document.getElementById(`unitName${i}`).value.trim();
        if (!name) {
          alert(`Please enter a name for Unit ${i + 1}.`);
          return;
        }
        unitNames.push(name);
      }
      showStep(3);
    });

    // Function to add a new bubble entry with two text fields.
    function addBubbleEntry() {
      const container = document.getElementById('bubbleEntriesContainer');
      const entryDiv = document.createElement('div');
      entryDiv.className = 'bubble-entry';

      // Text input for the room name (bubble label).
      const roomLabel = document.createElement('label');
      roomLabel.textContent = "Room Name (Bubble Label):";
      const roomInput = document.createElement('input');
      roomInput.type = 'text';
      roomInput.placeholder = 'e.g., Living Room';

      // Text input for the image file name.
      const fileLabel = document.createElement('label');
      fileLabel.textContent = "360 Image File Name:";
      const fileInput = document.createElement('input');
      fileInput.type = 'text';
      fileInput.placeholder = 'e.g., hall';

      entryDiv.appendChild(roomLabel);
      entryDiv.appendChild(roomInput);
      entryDiv.appendChild(fileLabel);
      entryDiv.appendChild(fileInput);

      container.appendChild(entryDiv);
    }

    // Add Bubble button handler.
    document.getElementById('addBubble').addEventListener('click', addBubbleEntry);

    // Finish button handler – logs the collected data.
    document.getElementById('finish').addEventListener('click', function() {
      const bubbleData = [];
      const entries = document.querySelectorAll('.bubble-entry');
      entries.forEach(entry => {
        // Retrieve both text inputs; first for room label, second for file name.
        const inputs = entry.querySelectorAll('input[type="text"]');
        const roomName = inputs[0].value.trim();
        const imageFileName = inputs[1].value.trim();
        if (!roomName || !imageFileName) {
          alert('Please complete all bubble entries.');
          return;
        }
        bubbleData.push({
          roomLabel: roomName,
          imageFileName: imageFileName
        });
      });
      console.log('Unit Names:', unitNames);
      console.log('Bubble Data:', bubbleData);
      alert('Setup finished! Check the console for output.');
    });

    // Initialize with one bubble entry by default.
    addBubbleEntry();
  </script>
</body>
</html>