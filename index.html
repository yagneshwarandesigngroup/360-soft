<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>360° Custom Software Setup</title>
  <style>
    body { font-family: "Poppins", sans-serif; padding: 20px; }
    .step { display: none; }
    .step.active { display: block; }
    .bubble-entry { margin-bottom: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
    input, select { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
    button { padding: 10px 15px; margin-top: 10px; cursor: pointer; }
    #addBubble { background-color: #007bff; color: #fff; border: none; border-radius: 5px; }
  </style>
</head>
<body>

  <!-- Step 1: Choose number of units -->
  <div id="step1" class="step active">
    <h2>Step 1: Choose Number of Units</h2>
    <select id="numUnitsSelect">
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5</option>
      <option value="6">6</option>
      <option value="Villa">Villa</option>
    </select>
    <br>
    <button id="next1">Next</button>
  </div>

  <!-- Step 2: Name the units -->
  <div id="step2" class="step">
    <h2>Step 2: Name Your Units</h2>
    <div id="unitNamesContainer"></div>
    <button id="next2">Next</button>
  </div>

  <!-- Step 3: Setup 360° Bubble Details -->
  <div id="step3" class="step">
    <h2>Step 3: Setup 360° Bubble Details</h2>
    <div id="bubbleEntriesContainer"></div>
    <button id="addBubble">+ Add Bubble</button>
    <br>
    <button id="finish">Finish Setup</button>
  </div>

  <script>
    let numUnits;
    let unitNames = [];

    function showStep(stepNumber) {
      document.querySelectorAll('.step').forEach((step, index) => {
        step.classList.toggle('active', index === stepNumber - 1);
      });
    }

    // Step 1: Select number of units
    document.getElementById('next1').addEventListener('click', function() {
      const selection = document.getElementById('numUnitsSelect').value;
      numUnits = selection === "Villa" ? 1 : parseInt(selection);
      
      const container = document.getElementById('unitNamesContainer');
      container.innerHTML = '';

      for (let i = 0; i < numUnits; i++) {
        const label = document.createElement('label');
        label.textContent = `Unit ${i + 1} Name:`;
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = selection === "Villa" ? "Villa" : `Enter name for Unit ${i + 1}`;
        if (selection === "Villa") input.value = "Villa";
        input.id = `unitName${i}`;
        container.appendChild(label);
        container.appendChild(input);
      }
      showStep(2);
    });

    // Step 2: Capture unit names and move to Step 3
    document.getElementById('next2').addEventListener('click', function() {
      unitNames = [];
      for (let i = 0; i < numUnits; i++) {
        const name = document.getElementById(`unitName${i}`).value.trim();
        if (!name) {
          alert(`Please enter a name for Unit ${i + 1}.`);
          return;
        }
        unitNames.push(name);
      }
      updateUnitDropdowns(); // Update dropdowns before moving to Step 3
      showStep(3);
    });

    // Function to update dropdowns for unit selection
    function updateUnitDropdowns() {
      document.querySelectorAll('.unitSelect').forEach(select => {
        select.innerHTML = ''; // Clear existing options
        unitNames.forEach(unit => {
          const option = document.createElement('option');
          option.value = unit;
          option.textContent = unit;
          select.appendChild(option);
        });
      });
    }

    // Function to add a new bubble entry
    function addBubbleEntry() {
      const container = document.getElementById('bubbleEntriesContainer');
      const entryDiv = document.createElement('div');
      entryDiv.className = 'bubble-entry';

      const roomLabel = document.createElement('label');
      roomLabel.textContent = "Room Name (Bubble Label):";
      const roomInput = document.createElement('input');
      roomInput.type = 'text';
      roomInput.placeholder = 'e.g., Living Room';

      const fileLabel = document.createElement('label');
      fileLabel.textContent = "360 Image File Name:";
      const fileInput = document.createElement('input');
      fileInput.type = 'text';
      fileInput.placeholder = 'e.g., hall';

      const unitLabel = document.createElement('label');
      unitLabel.textContent = "Select Unit:";
      const unitSelect = document.createElement('select');
      unitSelect.className = 'unitSelect';

      unitNames.forEach(unit => {
        const option = document.createElement('option');
        option.value = unit;
        option.textContent = unit;
        unitSelect.appendChild(option);
      });

      entryDiv.appendChild(roomLabel);
      entryDiv.appendChild(roomInput);
      entryDiv.appendChild(fileLabel);
      entryDiv.appendChild(fileInput);
      entryDiv.appendChild(unitLabel);
      entryDiv.appendChild(unitSelect);

      container.appendChild(entryDiv);
    }

    // Step 3: Add bubble entries
    document.getElementById('addBubble').addEventListener('click', function() {
      if (unitNames.length === 0) {
        alert("Please complete Step 2 first.");
        return;
      }
      addBubbleEntry();
    });

    // Step 3: Finish setup
    document.getElementById('finish').addEventListener('click', function() {
      const bubbleData = [];
      document.querySelectorAll('.bubble-entry').forEach(entry => {
        const roomName = entry.querySelectorAll('input')[0].value.trim();
        const imageFileName = entry.querySelectorAll('input')[1].value.trim();
        const selectedUnit = entry.querySelector('select').value;

        if (!roomName || !imageFileName || !selectedUnit) {
          alert("Please complete all fields.");
          return;
        }

        bubbleData.push({ roomLabel: roomName, imageFileName, unit: selectedUnit });
      });

      console.log("Unit Names:", unitNames);
      console.log("Bubble Data:", bubbleData);
      alert("Setup finished! Check console for output.");
    });

    // Initialize with one bubble entry by default when entering Step 3
    document.getElementById('next2').addEventListener('click', function() {
      document.getElementById('bubbleEntriesContainer').innerHTML = ''; // Clear previous entries
      addBubbleEntry();
    });

  </script>
</body>
</html>